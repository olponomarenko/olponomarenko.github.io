<!DOCTYPE html>
<html>

<head>
    <script>
        function myFunction() {
            var now = new Date().valueOf();
            setTimeout(function () {
                if (new Date().valueOf() - now > 5000) return;
                console.log('pre callback');
                window.location = "https://itunes.apple.com/appdir";
                console.log('after callback');
            }, 2000);

            console.log('pre app start');
            window.location = "swish://....";
        }
    </script>
</head>

<body>

    <h2>Demo JavaScript for launch mobile app</h2>

    <p id="demo">Let's go.</p>

    <button type="button" onclick="myFunction()">Try it</button>

</body>

</html>